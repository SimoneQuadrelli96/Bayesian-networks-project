getwd()
head(data)
library(gRbase)
library(gRim)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
head(data)
library(gRbase)
library(gRim)
data("milkcomp1")
head(milkcomp1)
help("milkcomp1")
# mean, covariance and count data for the conditioned distributions
SS<- CGstats(milkcomp1,varnames =c("treat","fat","protein","lactose"))
SS
head(milkcomp1)
colnames(data)
SS<- CGstats(data,varnames =colnames(data))
SS
SS$n.obs
# Analysis of milkcomp1 ---------------------------------------------------
data("milkcomp1")
head(milkcomp1)
help("milkcomp1")
# mean, covariance and count data for the conditioned distributions
SS<- CGstats(milkcomp1,varnames =c("treat","fat","protein","lactose"))
SS
View(SS)
View(SS)
SS<- CGstats(data,varnames =colnames(data))
SS
SS$center
SS<- CGstats(data,varnames =colnames(data))
SS<- CGstats(data,varnames =colnames(data))
SS
apply(SS$center,1,sd)/apply(SS$center,1,mean)
apply(SS$center,1,sd)/apply(SS$center,1,mean)
SS$center
apply(SS$center,1,sd)
apply(SS$center,1,mean)
sd(SS$center)/mean(SS$center)
# Analysis of milkcomp1 ---------------------------------------------------
data("milkcomp1")
head(milkcomp1)
help("milkcomp1")
# mean, covariance and count data for the conditioned distributions
SS<- CGstats(milkcomp1,varnames =c("treat","fat","protein","lactose"))
SS
# Coefficient of variation of the means (Between)
apply(SS$center,1,sd)/apply(SS$center,1,mean)
SS$center
head(milkcomp1)
head(milkcomp1)
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
head(data)
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
head(data)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
#head(data)
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
head(data)
SS<- CGstats(data,varnames =colnames(data))
SS
SS$center
head(milkcomp1)
milkcomp1$treat
levels(data)
levels(data$target)
levels(as.factor(data$target)
)
data$target <- as.factor(data$target)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- as.factor(data$target)
head(data)
levels(data$target)
SS<- CGstats(data,varnames =colnames(data))
SS
SS$center
data$ca <- as.factor(data$ca)
SS
SS$cov
help)(CGstats)
help(CGstats)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- as.factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- as.factor(data$fbs)
data$restecg <- as.factor(data$restecg)
data$exang <- as.factor(data$exang)
data$slope <- as.factor(data$slope)
data$ca <- as.factor(data$ca)
head(data)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- as.factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
head(data)
SS<- CGstats(data,varnames =colnames(data))
SS
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
head(data)
SS<- CGstats(data,varnames =colnames(data))
SS
data$thal[data$thal < 1]  <- 0
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(thal)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(data$thal)
head(data)
names(data)
library(gRbase)
library(gRim)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal[data$thal > 240]  <- 1
data$thal[data$thal <= 240]  <- 0
names(data)[names(data) == "chol"]
data$thal <- factor(data$thal)
head(data)
help(cad1)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal[data$thal > 240]  <- 1
data$thal[data$thal <= 240]  <- 0
names(data)[names(data) == "chol"] <- "Hyperchol"
data$thal <- factor(data$thal)
head(data)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(data$thal)
data$chol[data$chol > 240]  <- 1
data$chol[data$chol <= 240]  <- 0
names(data)[names(data) == "chol"] <- "Hyperchol"
data$thal <- factor(data$thal)
head(data)
SS<- CGstats(data,varnames =colnames(data))
SS
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(data$thal)
data$chol[data$chol > 240]  <- 1
data$chol[data$chol <= 240]  <- 0
names(data)[names(data) == "chol"] <- "Hyperchol"
data$chol <- factor(data$chol)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(data$thal)
data$chol[data$chol > 240]  <- 1
data$chol[data$chol <= 240]  <- 0
names(data)[names(data) == "chol"] <- "hyperchol"
data$hyperchol <- factor(data$hyperchol)
head(data)
SS
SS$center
SS$center
SS$center
library(gRbase)
library(gRim)
library(gRbase)
library(gRim)
# Analysis of milkcomp1 ---------------------------------------------------
data("milkcomp1")
head(milkcomp1)
help("milkcomp1")
# mean, covariance and count data for the conditioned distributions
SS<- CGstats(milkcomp1,varnames =c("treat","fat","protein","lactose"))
SS
# Canonical parameters
can.parms <- CGstats2mmodParms(SS,type="ghk")
can.parms
help(CGstats)
SS<- CGstats(data,varnames = c("target", "age", "trestbps", "thalach", "oldpeak")
SS
SS<- CGstats(data,varnames = c("target", "age", "trestbps", "thalach", "oldpeak"))
SS
library(gRbase)
library(gRim)
setwd("C:/Users/simon/Desktop/Graphical Model/probabilistic_modelling")
data <- read.csv(file = 'heart.csv')
data <- data[c(14,1,2,3,4,5,6,7,8,9,10,11,12,13)]
data$target <- factor(data$target)
data$sex <- factor(data$sex)
data$cp <- factor(data$cp)
data$fbs <- factor(data$fbs)
data$restecg <- factor(data$restecg)
data$exang <- factor(data$exang)
data$slope <- factor(data$slope)
data$ca <- factor(data$ca)
data$ca <- factor(data$ca)
# to make data comparable with th other dataset
data$thal[data$thal >= 1] <- 1
data$thal[data$thal < 1]  <- 0
data$thal <- factor(data$thal)
data$chol[data$chol > 240]  <- 1
data$chol[data$chol <= 240]  <- 0
names(data)[names(data) == "chol"] <- "hyperchol"
data$hyperchol <- factor(data$hyperchol)
head(data)
apply(SS$center,1,sd)/apply(SS$center,1,mean)
sd(SS$center)/mean(SS$center)
can.parms <- CGstats2mmodParms(SS,type="ghk")
can.parms
apply(can.parms$h,1,sd)/apply(can.parms$h,1,mean)
help(CGstats)
help(CGstats)
library('gRbase')
library('igraph')
library('gRim')
library('mvtnorm') # multivariate Gaussian distribution
library('matrixcalc') # operations with matrices
# simulation of a dataset from a multivariate normal given a concentration matrix
K <- matrix(c(0.8,0,0.4,
0,0.6,0.3,
0.4,0.3,0.5),byrow=T,nrow=3)
# check if the matrix K is invertible
is.positive.definite(K)
Sigma <- solve(K) #inverse of K
set.seed(625)
sim.data           <- rmvnorm(n=100000, mean=rep(0,3), sigma=Sigma)
colnames(sim.data) <- c("Y1","Y2","Y3")
sim.data           <- as.data.frame(sim.data)
head(sim.data)
mean <- apply(sim.data,2,mean)     #vector of means
# weighted ML estimates of covarianxce matrix
Sigma.hat <- cov.wt(sim.data,method="ML")$cov
# weighted ML estimates of concentration matrix
K.hat     <- solve(Sigma.hat)
round(K.hat,4)
# model estimation: cmod
fit.mod.sim <- cmod(~Y1*Y3+Y2*Y3,data=sim.data)
fit.mod.sim
pchisq(0.08,df=1,lower.tail = F)
gr.fit.mod.sim <- as(fit.mod.sim,"igraph")
x11()
data(carcass)
head(carcass)
help(carcass)
N <- nrow(carcass)
d <- ncol(carcass)
# weighted ML estimates of covarianxce matrix
S.carc <- cov.wt(carcass,method="ML")$cov
K.carc <- solve(S.carc)  # inverse
round(100*K.carc)
PC.carc <- cov2pcor(S.carc)
round(PC.carc*100)
